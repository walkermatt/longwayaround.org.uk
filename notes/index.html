<!DOCTYPE html>
<html lang="en">
<head>
        <title>longwayaround.org.uk - notes</title>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1, target-densitydpi=device-dpi">
        <link rel="stylesheet" href="https://longwayaround.org.uk/theme/css/main.css" type="text/css" />
        <link href="https://longwayaround.org.uk/feeds/all.rss.xml" type="application/atom+xml" rel="alternate" title="longwayaround.org.uk RSS Feed" />

        <!--[if IE]>
                <script src="http://html5shiv.googlecode.com/svn/trunk/html5.js"></script><![endif]-->

        <!--[if lte IE 7]>
                <link rel="stylesheet" type="text/css" media="all" href="https://longwayaround.org.uk/css/ie.css"/>
                <script src="https://longwayaround.org.uk/js/IE8.js" type="text/javascript"></script><![endif]-->

        <!--[if lt IE 7]>
                <link rel="stylesheet" type="text/css" media="all" href="https://longwayaround.org.uk/css/ie6.css"/><![endif]-->

</head>

<body id="index" class="home">
        <header id="banner" class="body">
                <h1><a href="/">longwayaround.org.uk  <strong>taking the scenic route and enjoying the journey</strong></a></h1>
                <nav>
                <ul>
                    <li class="active"><a href="https://longwayaround.org.uk/notes/">notes</a></li>
                </ul>
                </nav>
                    <ul class="social">
                        <li><a href="https://longwayaround.org.uk/feeds/all.rss.xml" rel="alternate"><img src="https://longwayaround.org.uk/theme/images/icons/gosquared/18/rss.png" title="rss" width="18" height="18" /></a></li>
                    <li><a href="https://uk.linkedin.com/in/walkermatt"><img src="https://longwayaround.org.uk/theme/images/icons/gosquared/18/linkedin.png" title="linkedin" width="18" height="18" /></a></li>
                    <li><a href="https://github.com/organizations/AstunTechnology"><img src="https://longwayaround.org.uk/theme/images/icons/gosquared/18/github.png" title="github" width="18" height="18" /></a></li>
                    <li><a href="https://github.com/walkermatt"><img src="https://longwayaround.org.uk/theme/images/icons/gosquared/18/github.png" title="github" width="18" height="18" /></a></li>
                    <li><a href="https://twitter.com/_walkermatt"><img src="https://longwayaround.org.uk/theme/images/icons/gosquared/18/twitter.png" title="twitter" width="18" height="18" /></a></li>
                    </ul>
        </header><!-- /#banner -->

            <aside id="featured" class="body">
                <article>
                    <abbr class="published" title="2023-03-27T11:20:00+01:00">Mon 27 March 2023</abbr>
                    <h1 class="entry-title"><a href="https://longwayaround.org.uk/notes/moving-gridref-to-flyio/">Moving gridref to fly.io</a></h1> 
                    <p>A few years ago I made an effort to learn <a class="reference external" href="http://clojure.org/">Clojure</a>, during which time I built a small Clojure library and command-line app <a class="reference external" href="https://github.com/walkermatt/gridref">GridRef</a> to convert between an Ordnance Survey GB grid reference and British National Grid coordinates. While I was at it I built a web API <a class="reference external" href="https://github.com/walkermatt/gridref-web">GridRef Web</a> which exposes the conversion functions via a <a class="reference external" href="https://github.com/ring-clojure/ring">Ring</a> web app. For several years gridref-web was deployed via Heroku on it's free-tier, following the free-tier coming to an end it needed a new home.</p>
<p>I saw mention of <a class="reference external" href="https://fly.io/">fly.io</a> a little while ago and saw they had a <a class="reference external" href="https://fly.io/docs/about/pricing/#free-allowances">genorious free tier</a> including support for custom domains, https and deployment via Docker so I thought I'd give it a go.</p>
<div class="section" id="creating-a-dockerfile">
<h2>Creating a Dockerfile</h2>
<p>The first step was to create a Docker container which turned out to be straight forward. This is the <code>Dockerfile</code> which is based on the <a class="reference external" href="https://hub.docker.com/_/clojure/">official clojure Docker image</a>:</p>
<div class="highlight"><pre><span></span><span class="k">FROM</span><span class="s"> clojure</span>
<span class="k">ENV</span> <span class="nv">PORT</span><span class="o">=</span><span class="m">8080</span>
<span class="k">ENV</span> <span class="nv">JVM_OPTS</span><span class="o">=</span><span class="s2">&quot;-Xmx250m&quot;</span>
<span class="k">COPY</span> . /usr/src/app
<span class="k">WORKDIR</span><span class="s"> /usr/src/app</span>
<span class="k">EXPOSE</span><span class="s"> ${PORT}</span>
<span class="k">CMD</span> lein run <span class="s2">&quot;</span><span class="si">${</span><span class="nv">PORT</span><span class="si">}</span><span class="s2">&quot;</span>
</pre></div>
<p>First we define a <code>PORT</code> environment variable which determines which port the embedded Jetty HTTP server will listen on. I'm defaulting to <code>8080</code> which is the default http port that fly.io will forward http requests to.</p>
<p>The <code>JVM_OPTS</code> environment variable is used to limit the amount of memory that our app can use, I've chosen <code>250m</code> which is slightly lower than the memory available to a fly.io instance on the <a class="reference external" href="https://fly.io/docs/about/pricing/#free-allowances">free tier</a>.</p>
<p>We then copy the contents of the repo to <code>/usr/src/app</code>, set the current directory (<code>WORKDIR</code>) to the same and <code>EXPOSE</code> the <code>PORT</code>.</p>
<p>Finally we start the app via <code>lein run</code> passing the value of the <code>PORT</code> environment variable which is handled by the <a class="reference external" href="https://github.com/walkermatt/gridref-web/blob/master/src/gridref_web/web.clj#L95">main method of GridRef Web</a>.</p>
</div>
<div class="section" id="build-and-run-locally">
<h2>Build and run locally</h2>
<p>The <code>Dockerfile</code> can be built and run locally via:</p>
<div class="highlight"><pre><span></span>docker build -t gridref-web .
docker run -it --rm --memory-swap 250m --memory 250m --env <span class="nv">PORT</span><span class="o">=</span><span class="m">8181</span> -p <span class="m">8181</span>:8181 --name gridref-web gridref-web
</pre></div>
<p>Specifying the same value for <cite>--memory-swap</cite> and <cite>--memory</cite> effectively limits the container to that much memory without swap which mimics the fly.io free-tier.</p>
<p>We're setting the <code>PORT</code> environment variable used in the Dockerfile to determine which port the Jetty listens on; the <code>-p</code> option exposes the container port to localhost for testing.</p>
<p>Visiting <code>http://localhost:8181</code> should load the home page.</p>
</div>
<div class="section" id="deploy-to-fly-io">
<h2>Deploy to fly.io</h2>
<p>First download and install <a class="reference external" href="https://fly.io/docs/#flyctl-your-cli-command-center">flyctl</a> before running the following to authenticate (and create an account):</p>
<div class="highlight"><pre><span></span>flyctl auth login
</pre></div>
<p>Then change to the root of the <code>gridref-web</code> repository and execute the following to configure the app for deployment via fly.io:</p>
<div class="highlight"><pre><span></span>flyctl launch
</pre></div>
<p>Running <code>flyctl launch</code> prompts for various options (shown below) and creates a <code>fly.toml</code> file which contains the apps configuration.</p>
<div class="highlight"><pre><span></span><span class="c1"># ? Choose an app name (leave blank to generate one): gridref-web</span>
<span class="c1"># ? Choose a region for deployment: London, United Kingdom (lhr)</span>
<span class="c1"># Created app &#39;gridref-web&#39; in organization &#39;personal&#39;</span>
<span class="c1"># ? Would you like to set up a Postgresql database now? No</span>
<span class="c1"># ? Would you like to set up an Upstash Redis database now? No</span>
<span class="c1"># ? Create .dockerignore from 3 .gitignore files? Yes</span>
<span class="c1"># ? Would you like to deploy now? No</span>
</pre></div>
<p>These choices resulted in the following <code>fly.toml</code>:</p>
<div class="highlight"><pre><span></span><span class="n">app</span> <span class="o">=</span> <span class="s">&quot;gridref-web&quot;</span>
<span class="n">kill_signal</span> <span class="o">=</span> <span class="s">&quot;SIGINT&quot;</span>
<span class="n">kill_timeout</span> <span class="o">=</span> <span class="mi">5</span>
<span class="n">primary_region</span> <span class="o">=</span> <span class="s">&quot;lhr&quot;</span>
<span class="n">processes</span> <span class="o">=</span> <span class="k">[]</span>

<span class="k">[env]</span>

<span class="k">[experimental]</span>
  <span class="n">auto_rollback</span> <span class="o">=</span> <span class="kc">true</span>

<span class="k">[[services]]</span>
  <span class="n">http_checks</span> <span class="o">=</span> <span class="k">[]</span>
  <span class="n">internal_port</span> <span class="o">=</span> <span class="mi">8080</span>
  <span class="n">processes</span> <span class="o">=</span> <span class="k">[&quot;app&quot;]</span>
  <span class="n">protocol</span> <span class="o">=</span> <span class="s">&quot;tcp&quot;</span>
  <span class="n">script_checks</span> <span class="o">=</span> <span class="k">[]</span>
  <span class="k">[services.concurrency]</span>
    <span class="n">hard_limit</span> <span class="o">=</span> <span class="mi">25</span>
    <span class="n">soft_limit</span> <span class="o">=</span> <span class="mi">20</span>
    <span class="n">type</span> <span class="o">=</span> <span class="s">&quot;connections&quot;</span>

  <span class="k">[[services.ports]]</span>
    <span class="n">force_https</span> <span class="o">=</span> <span class="kc">true</span>
    <span class="n">handlers</span> <span class="o">=</span> <span class="k">[&quot;http&quot;]</span>
    <span class="n">port</span> <span class="o">=</span> <span class="mi">80</span>

  <span class="k">[[services.ports]]</span>
    <span class="n">handlers</span> <span class="o">=</span> <span class="k">[&quot;tls&quot;, &quot;http&quot;]</span>
    <span class="n">port</span> <span class="o">=</span> <span class="mi">443</span>

  <span class="k">[[services.tcp_checks]]</span>
    <span class="n">grace_period</span> <span class="o">=</span> <span class="s">&quot;1s&quot;</span>
    <span class="n">interval</span> <span class="o">=</span> <span class="s">&quot;15s&quot;</span>
    <span class="n">restart_limit</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">timeout</span> <span class="o">=</span> <span class="s">&quot;2s&quot;</span>
</pre></div>
<p>I couldn't see any obvious changes to <code>fly.toml</code> so I moved onto deploying via:</p>
<div class="highlight"><pre><span></span>flyctl deploy
</pre></div>
<p>At this point the gridref-web application is available at <a class="reference external" href="https://gridref-web.fly.dev/">https://gridref-web.fly.dev/</a>.</p>
<p>The application is available by default via https on fly.io (with a redirect from http), I had to make a <a class="reference external" href="https://github.com/walkermatt/gridref-web/commit/ff2b5b6bb62ec78f2816ae48ffda8e9b68c1efde">small change to the code</a> to use the <code>x-forwarded-proto</code> header to determine the client protocol to ensure the links shown on the home page use the correct protocol as fly.io makes requests to my application running in Docker via plain http.</p>
</div>
<div class="section" id="custom-domain-and-certificate">
<h2>Custom domain and certificate</h2>
<p>Setting up a custom domain and associated certificate for http traffic involved:</p>
<ol class="arabic simple">
<li>Creating a CNAME to point <code>gridref.longwayaround.org.uk</code> at <code>gridref-web.fly.dev.</code></li>
<li>Once the CNAME had propagated, requesting a certificate via the <cite>flyctl</cite>:</li>
</ol>
<div class="highlight"><pre><span></span>flyctl certs create gridref.longwayaround.org.uk
</pre></div>
<p>The web application is now available at <a class="reference external" href="https://gridref.longwayaround.org.uk/">https://gridref.longwayaround.org.uk/</a> 🎉</p>
<p>The application has been running for a few weeks without any issues, it's now running via https and is more responsive due to the instance always being available.</p>
</div>

<footer class="post-info">
    <abbr class="published" title="2023-03-27T11:20:00+01:00">Mon 27 March 2023</abbr>
<p>Tags: <a href="https://longwayaround.org.uk/tag/command-line.html">command-line</a> <a href="https://longwayaround.org.uk/tag/geo.html">geo</a> <a href="https://longwayaround.org.uk/tag/clojure.html">clojure</a> <a href="https://longwayaround.org.uk/tag/notes.html">notes</a> </p></footer><!-- /.post-info -->                    <p><a href="https://longwayaround.org.uk/notes/moving-gridref-to-flyio/#disqus_thread">comments</a>.</p>
                </article>
            </aside><!-- /#featured -->
                <section id="content" class="body">
                    <h1>Other posts</h1>
                    <hr />
                        <ol id="posts-list" class="hfeed">

 
            <li><article class="hentry">
                <header>
                        <abbr class="published" title="2022-09-05T08:05:00+01:00">Mon 05 September 2022</abbr>
                        <h1><a href="https://longwayaround.org.uk/notes/web-mercator-os-vector-tile-api-in-openlayers-take-2/" rel="bookmark" title="Permalink to Web Mercator OS Vector Tile API in OpenLayers - Take #2">Web Mercator OS Vector Tile API in OpenLayers - Take #2</a></h1>
                </header>
                <div class="entry-content">
                <div class="slug">
                    <p>This is an update to my <a class="reference external" href="/notes/web-mercator-os-vector-tile-api-in-openlayers/">previous post</a> on the same subject.</p>
<p>Thanks to <a class="reference external" href="https://twitter.com/ahoce/status/1545409888226099200">some feedback from Andreas Hocevar</a> and <a class="reference external" href="https://github.com/openlayers/ol-mapbox-style/pull/618">a pull request I made to ol-mapbox-style</a> adding a Vector Tile layer of Ordnance Survey data from the OS Data Hub to an OpenLayers map in Web Mercator is a …</p>
                    <p>
<a href="https://longwayaround.org.uk/notes/web-mercator-os-vector-tile-api-in-openlayers-take-2/#disqus_thread">comments</a>.                        <a class="readmore" href="https://longwayaround.org.uk/notes/web-mercator-os-vector-tile-api-in-openlayers-take-2/">read more</a>
                    </p>
                </div>
                </div><!-- /.entry-content -->
            </article></li>

 
            <li><article class="hentry">
                <header>
                        <abbr class="published" title="2022-06-23T21:56:00+01:00">Thu 23 June 2022</abbr>
                        <h1><a href="https://longwayaround.org.uk/notes/web-mercator-os-vector-tile-api-in-openlayers/" rel="bookmark" title="Permalink to Web Mercator OS Vector Tile API in OpenLayers">Web Mercator OS Vector Tile API in OpenLayers</a></h1>
                </header>
                <div class="entry-content">
                <div class="slug">
                    <p>Adding a Vector Tile layer of Ordnance Survey data from the OS Data Hub to an OpenLayers map in Web Mercator is a little more work than expected as the JSON style document and associated JSON source document include paths for the default British National Grid tiles. The following is …</p>
                    <p>
<a href="https://longwayaround.org.uk/notes/web-mercator-os-vector-tile-api-in-openlayers/#disqus_thread">comments</a>.                        <a class="readmore" href="https://longwayaround.org.uk/notes/web-mercator-os-vector-tile-api-in-openlayers/">read more</a>
                    </p>
                </div>
                </div><!-- /.entry-content -->
            </article></li>

 
            <li><article class="hentry">
                <header>
                        <abbr class="published" title="2022-06-22T21:56:00+01:00">Wed 22 June 2022</abbr>
                        <h1><a href="https://longwayaround.org.uk/notes/writing-small-text-filters-for-the-shell-and-vim/" rel="bookmark" title="Permalink to Writing small text filters for the shell and Vim">Writing small text filters for the shell and Vim</a></h1>
                </header>
                <div class="entry-content">
                <div class="slug">
                    <p>Text filters are command-line programs that take text as input, transform it then output the results. An example of a common built in text filter is <tt class="docutils literal">sort</tt> which when passed newline separated text will sort each line:</p>
<div class="highlight"><pre><span></span><span class="nb">printf</span> <span class="s1">&#39;b\nc\na&#39;</span> <span class="p">|</span> sort
</pre></div>
<p>You can write your own text filter scripts …</p>
                    <p>
<a href="https://longwayaround.org.uk/notes/writing-small-text-filters-for-the-shell-and-vim/#disqus_thread">comments</a>.                        <a class="readmore" href="https://longwayaround.org.uk/notes/writing-small-text-filters-for-the-shell-and-vim/">read more</a>
                    </p>
                </div>
                </div><!-- /.entry-content -->
            </article></li>

 
            <li><article class="hentry">
                <header>
                        <abbr class="published" title="2019-09-20T12:00:00+01:00">Fri 20 September 2019</abbr>
                        <h1><a href="https://longwayaround.org.uk/notes/mapserver-postgis-performance/" rel="bookmark" title="Permalink to MapServer PostGIS Performance">MapServer PostGIS Performance</a></h1>
                </header>
                <div class="entry-content">
                <div class="slug">
                    <p>Recently I was looking at improving the performance of rendering a <a class="reference external" href="https://github.com/spacesyntax/OpenMapping">Space Syntax OpenMapping</a> layer in MapServer. The <code>openmapping_gb_v1</code> table is in a PostGIS database with an index on the geometry column. The original MapServer <code>DATA</code> configuration looked like this:</p>
<div class="highlight"><pre><span></span>DATA &quot;wkb_geometry from (select meridian_class_scale * 10 as line_width, * from openmapping …</pre></div>
                    <p>
<a href="https://longwayaround.org.uk/notes/mapserver-postgis-performance/#disqus_thread">comments</a>.                        <a class="readmore" href="https://longwayaround.org.uk/notes/mapserver-postgis-performance/">read more</a>
                    </p>
                </div>
                </div><!-- /.entry-content -->
            </article></li>

 
            <li><article class="hentry">
                <header>
                        <abbr class="published" title="2017-02-18T07:55:00+00:00">Sat 18 February 2017</abbr>
                        <h1><a href="https://longwayaround.org.uk/notes/postgres-information-functions/" rel="bookmark" title="Permalink to Postgres Information Functions">Postgres Information Functions</a></h1>
                </header>
                <div class="entry-content">
                <div class="slug">
                    <p>Postgres contains a wealth of functions that provide information about a database and the objects within. The <a class="reference external" href="https://www.postgresql.org/docs/current/static/functions-info.html/">System Information Functions of the official documention</a> provides a full list. There are a huge number of functions covering a whole host of info from the current database session, privileges, function properties.</p>
<div class="section" id="examples">
<h2>Examples …</h2></div>
                    <p>
<a href="https://longwayaround.org.uk/notes/postgres-information-functions/#disqus_thread">comments</a>.                        <a class="readmore" href="https://longwayaround.org.uk/notes/postgres-information-functions/">read more</a>
                    </p>
                </div>
                </div><!-- /.entry-content -->
            </article></li>

 
            <li><article class="hentry">
                <header>
                        <abbr class="published" title="2016-04-26T14:00:00+01:00">Tue 26 April 2016</abbr>
                        <h1><a href="https://longwayaround.org.uk/notes/openlayers-2-custom-build/" rel="bookmark" title="Permalink to OpenLayers 2 Custom Build">OpenLayers 2 Custom Build</a></h1>
                </header>
                <div class="entry-content">
                <div class="slug">
                    <p>A bit of a blast from the past now that OpenLayers 3 has been released but it may be useful for someone who is working on or maintaining an OpenLayer 2 project.</p>
<p>Create a list of OpenLayers 2 classes used within a code base suitable for including in a <a class="reference external" href="http://docs.openlayers.org/library/deploying.html#custom-build-profiles">custom …</a></p>
                    <p>
<a href="https://longwayaround.org.uk/notes/openlayers-2-custom-build/#disqus_thread">comments</a>.                        <a class="readmore" href="https://longwayaround.org.uk/notes/openlayers-2-custom-build/">read more</a>
                    </p>
                </div>
                </div><!-- /.entry-content -->
            </article></li>

 
            <li><article class="hentry">
                <header>
                        <abbr class="published" title="2015-10-12T21:00:00+01:00">Mon 12 October 2015</abbr>
                        <h1><a href="https://longwayaround.org.uk/notes/testing-python-postgres/" rel="bookmark" title="Permalink to Testing Python &amp; Postgres">Testing Python &amp; Postgres</a></h1>
                </header>
                <div class="entry-content">
                <div class="slug">
                    <p>I recently pulled together <a class="reference external" href="https://github.com/walkermatt/python-postgres-testing-demo/">a project to demonstrate testing Python functions that interact with a Postgres database</a>. I find that this sort of thing crops up occasionally and the project is an attempt to distil the approach. The main points include:</p>
<ul class="simple">
<li>Creating a fresh temporary database via testing.postgresql prior …</li></ul>
                    <p>
<a href="https://longwayaround.org.uk/notes/testing-python-postgres/#disqus_thread">comments</a>.                        <a class="readmore" href="https://longwayaround.org.uk/notes/testing-python-postgres/">read more</a>
                    </p>
                </div>
                </div><!-- /.entry-content -->
            </article></li>

 
            <li><article class="hentry">
                <header>
                        <abbr class="published" title="2015-09-08T13:00:00+01:00">Tue 08 September 2015</abbr>
                        <h1><a href="https://longwayaround.org.uk/notes/read-only-postgres-database/" rel="bookmark" title="Permalink to Read-only Postgres database">Read-only Postgres database</a></h1>
                </header>
                <div class="entry-content">
                <div class="slug">
                    <p>There are times when I've needed to effectively make a Postgres database read-only, for example after loading or updating reference data. In the past I've revoked permissions from database roles to achieve this but as <a class="reference external" href="http://www.postgresql.org/message-id/5fe0d78bda51d7176940fb8e78739b54&#64;biglumber.com">this post on the PostgreSQL list states, it's possible to do so by making all …</a></p>
                    <p>
<a href="https://longwayaround.org.uk/notes/read-only-postgres-database/#disqus_thread">comments</a>.                        <a class="readmore" href="https://longwayaround.org.uk/notes/read-only-postgres-database/">read more</a>
                    </p>
                </div>
                </div><!-- /.entry-content -->
            </article></li>

 
            <li><article class="hentry">
                <header>
                        <abbr class="published" title="2014-11-20T00:00:00+00:00">Thu 20 November 2014</abbr>
                        <h1><a href="https://longwayaround.org.uk/notes/loading-postgis/" rel="bookmark" title="Permalink to Loading PostGIS">Loading PostGIS</a></h1>
                </header>
                <div class="entry-content">
                <div class="slug">
                    <p><em>Notes from a talk at PostGIS Day, London 20th Nov 2014.</em></p>
<div class="section" id="the-options">
<h2>The options</h2>
<p>All support basic options such as specifying table names, schema, SRS etc.</p>
<div class="section" id="graphical">
<h3>Graphical</h3>
<dl class="docutils">
<dt><a class="reference external" href="http://gothos.info/2014/03/loading-data-into-postgis-shapefiles/">shp2pgsql-gui</a></dt>
<dd>Graphical interface to shp2pgsql tool shipped with PostGIS to load ESRI Shapefiles via pgAdmin III.</dd>
<dt><a class="reference external" href="https://github.com/zer0infinity/OGR2GUI">ogr2gui</a></dt>
<dd>Graphical interface to <code>ogr2ogr</code> command line utility …</dd></dl></div></div>
                    <p>
<a href="https://longwayaround.org.uk/notes/loading-postgis/#disqus_thread">comments</a>.                        <a class="readmore" href="https://longwayaround.org.uk/notes/loading-postgis/">read more</a>
                    </p>
                </div>
                </div><!-- /.entry-content -->
            </article></li>

 
            <li><article class="hentry">
                <header>
                        <abbr class="published" title="2014-09-07T21:30:00+01:00">Sun 07 September 2014</abbr>
                        <h1><a href="https://longwayaround.org.uk/notes/practical-openlayers-3-leaflet/" rel="bookmark" title="Permalink to Practical OpenLayers 3 &amp; Leaflet">Practical OpenLayers 3 &amp; Leaflet</a></h1>
                </header>
                <div class="entry-content">
                <div class="slug">
                    <p>I ran a 2 hour workshop at <a class="reference external" href="http://www.nottingham.ac.uk/osgis/home.aspx">OSGIS 2014</a> introducing OpenLayers 3 and
Leaflet.</p>
<blockquote>
A hands on introduction to using OpenLayer 3 (OL3) and Leaflet to display
spatial data on the web. The workshop will introduce the two libraries, the
underpinning concepts and strengths of each, and take delegates through …</blockquote>
                    <p>
<a href="https://longwayaround.org.uk/notes/practical-openlayers-3-leaflet/#disqus_thread">comments</a>.                        <a class="readmore" href="https://longwayaround.org.uk/notes/practical-openlayers-3-leaflet/">read more</a>
                    </p>
                </div>
                </div><!-- /.entry-content -->
            </article></li>

 
            <li><article class="hentry">
                <header>
                        <abbr class="published" title="2014-07-17T19:45:00+01:00">Thu 17 July 2014</abbr>
                        <h1><a href="https://longwayaround.org.uk/notes/gnu-parallel-all-the-things/" rel="bookmark" title="Permalink to GNU Parallel all the things!">GNU Parallel all the things!</a></h1>
                </header>
                <div class="entry-content">
                <div class="slug">
                    <p>I've been doing a lot of data processing recently and have been looking for a way of running bulk data loads into PostGIS in parallel to make use of all available cores. The work has mainly revolved around loading national cover of Ordnance Survey OS MasterMap and VectorMap Local for …</p>
                    <p>
<a href="https://longwayaround.org.uk/notes/gnu-parallel-all-the-things/#disqus_thread">comments</a>.                        <a class="readmore" href="https://longwayaround.org.uk/notes/gnu-parallel-all-the-things/">read more</a>
                    </p>
                </div>
                </div><!-- /.entry-content -->
            </article></li>

 
            <li><article class="hentry">
                <header>
                        <abbr class="published" title="2014-02-18T19:42:00+00:00">Tue 18 February 2014</abbr>
                        <h1><a href="https://longwayaround.org.uk/notes/first-few-months-of-clojure/" rel="bookmark" title="Permalink to First few months of Clojure">First few months of Clojure</a></h1>
                </header>
                <div class="entry-content">
                <div class="slug">
                    <p>I've been learning a bit of Lisp on and off for a few years, I first read (about half of) <a class="reference external" href="http://landoflisp.com/">Land of Lisp</a>, then <a class="reference external" href="http://www.gigamonkeys.com/book/">Practical Lisp</a> then I came across <a class="reference external" href="http://clojure.org/">Clojure</a> a modern Lisp that runs on the JVM and since I've been reading <a class="reference external" href="http://www.clojurebook.com/">Clojure Programming</a> and working through <a class="reference external" href="https://github.com/walkermatt/clojure-koans">koans …</a></p>
                    <p>
<a href="https://longwayaround.org.uk/notes/first-few-months-of-clojure/#disqus_thread">comments</a>.                        <a class="readmore" href="https://longwayaround.org.uk/notes/first-few-months-of-clojure/">read more</a>
                    </p>
                </div>
                </div><!-- /.entry-content -->
            </article></li>

 
            <li><article class="hentry">
                <header>
                        <abbr class="published" title="2013-10-18T17:24:00+01:00">Fri 18 October 2013</abbr>
                        <h1><a href="https://longwayaround.org.uk/notes/custom-geoserver-getfeatureinfo-template/" rel="bookmark" title="Permalink to Custom GeoServer GetFeatureInfo Template">Custom GeoServer GetFeatureInfo Template</a></h1>
                </header>
                <div class="entry-content">
                <div class="slug">
                    <p>The default  <a class="reference external" href="http://geoserver.org/">GeoServer</a> GetFeatureInfo Freemarker template is a simple table and doesn't work very well when displaying the content in a web map popup. It's a common requirement to change the GetFeatureInfo template to an unordered list, to capitalise the title and attribute names. Here is a sample <cite>content.ftl …</cite></p>
                    <p>
<a href="https://longwayaround.org.uk/notes/custom-geoserver-getfeatureinfo-template/#disqus_thread">comments</a>.                        <a class="readmore" href="https://longwayaround.org.uk/notes/custom-geoserver-getfeatureinfo-template/">read more</a>
                    </p>
                </div>
                </div><!-- /.entry-content -->
            </article></li>

 
            <li><article class="hentry">
                <header>
                        <abbr class="published" title="2012-07-02T21:06:00+01:00">Mon 02 July 2012</abbr>
                        <h1><a href="https://longwayaround.org.uk/notes/using-leaflet-with-a-custom-projection-and-a-mapproxy-tms/" rel="bookmark" title="Permalink to Using Leaflet with a custom projection and a MapProxy TMS">Using Leaflet with a custom projection and a MapProxy TMS</a></h1>
                </header>
                <div class="entry-content">
                <div class="slug">
                    <p><strong>Update 2014-09-07</strong> I've just ran a workshop based on the Astun Leaflet &amp; and
ol3 examples at <a class="reference external" href="http://www.nottingham.ac.uk/osgis/home.aspx">OSGIS 2014</a>,
see <a class="reference external" href="/notes/practical-openlayers-3-leaflet/">Practical OpenLayers 3 &amp; Leaflet</a> for details.</p>
<p><strong>Update 2014-05-15</strong> For examples of displaying a Web Map Service (WMS) layer
in a custom projection (EPSG:27700) within Leaflet and OpenLayers 3 (ol3) see …</p>
                    <p>
<a href="https://longwayaround.org.uk/notes/using-leaflet-with-a-custom-projection-and-a-mapproxy-tms/#disqus_thread">comments</a>.                        <a class="readmore" href="https://longwayaround.org.uk/notes/using-leaflet-with-a-custom-projection-and-a-mapproxy-tms/">read more</a>
                    </p>
                </div>
                </div><!-- /.entry-content -->
            </article></li>

 
            <li><article class="hentry">
                <header>
                        <abbr class="published" title="2012-02-02T21:31:00+00:00">Thu 02 February 2012</abbr>
                        <h1><a href="https://longwayaround.org.uk/notes/greyscale-maps-with-mapserver/" rel="bookmark" title="Permalink to Greyscale maps with MapServer">Greyscale maps with MapServer</a></h1>
                </header>
                <div class="entry-content">
                <div class="slug">
                    <p>There have been a few times in the past (such as when I was preparing the base mapping for <a class="reference external" href="http://mywycombe.wycombe.gov.uk/?tab=2">My Wycombe</a>) when I've wanted to create greyscale base mapping using <a class="reference external" href="http://mapserver.org">MapServer</a>. Previously I've experimented with various processing options for raster images (with varying degrees of success), converting the source images …</p>
                    <p>
<a href="https://longwayaround.org.uk/notes/greyscale-maps-with-mapserver/#disqus_thread">comments</a>.                        <a class="readmore" href="https://longwayaround.org.uk/notes/greyscale-maps-with-mapserver/">read more</a>
                    </p>
                </div>
                </div><!-- /.entry-content -->
            </article></li>

 
            <li><article class="hentry">
                <header>
                        <abbr class="published" title="2011-11-24T21:39:00+00:00">Thu 24 November 2011</abbr>
                        <h1><a href="https://longwayaround.org.uk/notes/disaggregate-multilinestrings-using-st_dump-postgis/" rel="bookmark" title="Permalink to Disaggregate MultiLineStrings using ST_Dump PostGIS">Disaggregate MultiLineStrings using ST_Dump PostGIS</a></h1>
                </header>
                <div class="entry-content">
                <div class="slug">
                    <p>PostGIS the spatial extension to the PostgreSQL database provides a host of functions for querying, creating and manipulating geometries within the database. ST_Dump allows you to disaggregate collection and multi geometries such as MultiPolygon and MultiLineSting easily. The example below demonstrates starting with a table that contains one row with …</p>
                    <p>
<a href="https://longwayaround.org.uk/notes/disaggregate-multilinestrings-using-st_dump-postgis/#disqus_thread">comments</a>.                        <a class="readmore" href="https://longwayaround.org.uk/notes/disaggregate-multilinestrings-using-st_dump-postgis/">read more</a>
                    </p>
                </div>
                </div><!-- /.entry-content -->
            </article></li>

 
            <li><article class="hentry">
                <header>
                        <abbr class="published" title="2011-03-28T10:31:00+01:00">Mon 28 March 2011</abbr>
                        <h1><a href="https://longwayaround.org.uk/notes/recursively-delete-empty-directories/" rel="bookmark" title="Permalink to Recursively delete empty directories">Recursively delete empty directories</a></h1>
                </header>
                <div class="entry-content">
                <div class="slug">
                    <p>To recursively delete all empty directories from the command prompt in Windows. Open command prompt and change to the desired directory then enter the following:</p>
<div class="highlight"><pre><span></span><span class="k">for</span> /F <span class="s2">&quot;tokens=*&quot;</span> %f in <span class="o">(</span><span class="s1">&#39;dir /AD /S /B ^| sort /R&#39;</span><span class="o">)</span> <span class="k">do</span> <span class="nb">echo</span> rd <span class="s2">&quot;%f&quot;</span>
</pre></div>
<p>This command generates a list of all directories and sub …</p>
                    <p>
<a href="https://longwayaround.org.uk/notes/recursively-delete-empty-directories/#disqus_thread">comments</a>.                        <a class="readmore" href="https://longwayaround.org.uk/notes/recursively-delete-empty-directories/">read more</a>
                    </p>
                </div>
                </div><!-- /.entry-content -->
            </article></li>

 
            <li><article class="hentry">
                <header>
                        <abbr class="published" title="2011-01-07T17:53:00+00:00">Fri 07 January 2011</abbr>
                        <h1><a href="https://longwayaround.org.uk/notes/convert-a-directory-of-tiffs-to-greyscale-using-imagemagick/" rel="bookmark" title="Permalink to Convert a directory of TIFFs to greyscale using ImageMagick">Convert a directory of TIFFs to greyscale using ImageMagick</a></h1>
                </header>
                <div class="entry-content">
                <div class="slug">
                    <p>Change to the directory then run the command:</p>
<div class="highlight"><pre><span></span>mogrify -colorspace Gray *.tif
</pre></div>

                    <p>
<a href="https://longwayaround.org.uk/notes/convert-a-directory-of-tiffs-to-greyscale-using-imagemagick/#disqus_thread">comments</a>.                        <a class="readmore" href="https://longwayaround.org.uk/notes/convert-a-directory-of-tiffs-to-greyscale-using-imagemagick/">read more</a>
                    </p>
                </div>
                </div><!-- /.entry-content -->
            </article></li>

 
            <li><article class="hentry">
                <header>
                        <abbr class="published" title="2010-12-19T21:06:00+00:00">Sun 19 December 2010</abbr>
                        <h1><a href="https://longwayaround.org.uk/notes/build-ogr-18-with-gml-wfs-and-postgis-support-on-ubuntu-1004/" rel="bookmark" title="Permalink to Build OGR 1.8 with GML, WFS and PostGIS support on Ubuntu 10.04">Build OGR 1.8 with GML, WFS and PostGIS support on Ubuntu 10.04</a></h1>
                </header>
                <div class="entry-content">
                <div class="slug">
                    <p>OGR 1.8 introduces support for reading GML with feature attributes expressed as nested elements as found in Ordnance Survey's OS MasterMap as well as support for accessing WFS. This is a brief script for building OGR (GDAL) 1.8 from source as it's not currently released: Download latest daily …</p>
                    <p>
<a href="https://longwayaround.org.uk/notes/build-ogr-18-with-gml-wfs-and-postgis-support-on-ubuntu-1004/#disqus_thread">comments</a>.                        <a class="readmore" href="https://longwayaround.org.uk/notes/build-ogr-18-with-gml-wfs-and-postgis-support-on-ubuntu-1004/">read more</a>
                    </p>
                </div>
                </div><!-- /.entry-content -->
            </article></li>
    </ol><!-- /#posts-list -->
        <section id="extras" class="body">
        </section><!-- /#extras -->

        <footer id="contentinfo" class="body">
                <address id="about" class="vcard body">
                    Powered by <a href="http://alexis.notmyidea.org/pelican/">Pelican</a> and <a href="http://python.org">Python</a>, using a modified <a href="http://coding.smashingmagazine.com/2009/08/04/designing-a-html-5-layout-from-scratch/">Smashing Magazine</a> theme, background from <a href="http://subtlepatterns.com">Subtle Patterns</a> and icons from <a href="https://www.gosquared.com/blog/archives/2925">GoSocial</a>.
                </address><!-- /#about -->
        </footer><!-- /#contentinfo -->

<script type="text/javascript">
    var disqus_shortname = 'longwayaroundorguk';
    (function () {
        var s = document.createElement('script'); s.async = true;
        s.type = 'text/javascript';
        s.src = 'https://' + disqus_shortname + '.disqus.com/count.js';
        (document.getElementsByTagName('HEAD')[0] || document.getElementsByTagName('BODY')[0]).appendChild(s);
    }());
</script>
</body>
</html>